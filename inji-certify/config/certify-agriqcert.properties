# ===========================================
# INJI CERTIFY - AGRIQCERT CONFIGURATION
# Digital Product Passport (DPP) for Agricultural Products
# ===========================================

## Integration Plugin Configuration
# Package to scan for plugin implementations (using Postgres DataProvider plugin)
mosip.certify.integration.scan-base-package=io.mosip.certify.postgresdataprovider.integration

## DataProvider Plugin Configuration
mosip.certify.data-provider-plugin.issuer-uri=http://localhost:8090/v1/certify
mosip.certify.data-provider-plugin.issuer-public-key-uri=http://localhost:8090/v1/certify/system-info/certificate?applicationId=CERTIFY_VC_SIGN_ED25519&referenceId=ED25519_SIGN

## DID Configuration
# This should be updated to your hosted DID location (e.g., GitHub Pages, your domain)
mosip.certify.data-provider-plugin.did-url=did:web:localhost:8090:v1:certify

## Postgres DataProvider Plugin Configuration
mosip.certify.data-provider-plugin.postgres.datasource.url=jdbc:postgresql://postgres:5432/agriqcert_db
mosip.certify.data-provider-plugin.postgres.datasource.username=postgres
mosip.certify.data-provider-plugin.postgres.datasource.password=postgres
mosip.certify.data-provider-plugin.postgres.datasource.driver-class-name=org.postgresql.Driver

## Query Configuration for Agricultural Batch Data
# Query to fetch batch and inspection data for VC issuance
# Uses batch_number as identifier (passed as 'id' parameter)
mosip.certify.data-provider-plugin.postgres.query=\
  SELECT \
    b.id as batch_id, \
    b.batch_number, \
    b.product_type, \
    b.product_name, \
    b.quantity, \
    b.unit, \
    b.origin_location, \
    b.destination_country, \
    b.harvest_date, \
    b.packaging_type, \
    b.storage_conditions, \
    b.hsn_code, \
    b.status, \
    b.submitted_at, \
    u.full_name as exporter_name, \
    u.email as exporter_email, \
    u.organization as exporter_organization, \
    u.license_number as exporter_license, \
    i.inspection_date, \
    i.moisture_level, \
    i.pesticide_details, \
    i.aflatoxin_level, \
    i.foreign_matter, \
    i.grain_quality_score, \
    i.is_organic, \
    i.is_gmo_free, \
    i.meets_iso_22000, \
    i.meets_haccp, \
    i.iso_code, \
    i.compliance_standards, \
    i.inspector_name, \
    i.inspector_license, \
    i.lab_name, \
    i.lab_accreditation, \
    i.inspection_result, \
    i.remarks, \
    qa.full_name as qa_agency_name, \
    qa.organization as qa_organization \
  FROM batches b \
  INNER JOIN users u ON b.exporter_id = u.id \
  INNER JOIN inspections i ON b.id = i.batch_id \
  INNER JOIN users qa ON i.qa_agency_id = qa.id \
  WHERE b.batch_number = :id AND b.status = 'certified'

## Velocity Template for Digital Product Passport
# The template will be stored in the database during initialization
mosip.certify.data-provider-plugin.velocity-template-id=digital_product_passport_v1

## Credential Type Configuration
mosip.certify.credential-type.digital-product-passport.format=ldp_vc
mosip.certify.credential-type.digital-product-passport.context=["https://www.w3.org/2018/credentials/v1", "https://w3id.org/tracability/v1"]
mosip.certify.credential-type.digital-product-passport.type=["VerifiableCredential", "DigitalProductPassport", "AgriculturalQualityCertificate"]

## SD-JWT Configuration (if using SD-JWT format)
mosip.certify.credential-type.digital-product-passport-sdjwt.format=vc+sd-jwt
mosip.certify.credential-type.digital-product-passport-sdjwt.vct=DigitalProductPassport_v1
mosip.certify.credential-type.digital-product-passport-sdjwt.selective-disclosure-fields=["pesticide_details","aflatoxin_level","moisture_level","foreign_matter","grain_quality_score"]

## Signing Configuration
mosip.certify.digital-product-passport.signature-crypto-suite=Ed25519Signature2020
mosip.certify.digital-product-passport.signature-algo=EdDSA
mosip.certify.digital-product-passport.key-manager-app-id=CERTIFY_VC_SIGN_ED25519
mosip.certify.digital-product-passport.key-manager-ref-id=ED25519_SIGN

## Credential Validity
mosip.certify.credential.validity.years=2
mosip.certify.credential.validity.days=0

## QR Code Configuration
mosip.certify.qr-code.size=400
mosip.certify.qr-code.format=PNG
mosip.certify.qr-code.error-correction=M

## Revocation Configuration
mosip.certify.revocation.enabled=true
mosip.certify.revocation.status-list-credential-id=https://localhost:8090/v1/certify/credentials/status/agricultural-batch-revocation-list

## Well-Known Configuration
mosip.certify.key-values={\
  'v1/certify': {\
    '@context': [\
      'https://www.w3.org/2018/credentials/v1',\
      'https://w3id.org/tracability/v1'\
    ],\
    'issuer': '${mosip.certify.data-provider-plugin.did-url}',\
    'credential_issuer': '${mosip.certify.data-provider-plugin.issuer-uri}',\
    'authorization_servers': ['${mosip.certify.authorization.url}'],\
    'credential_endpoint': '${mosip.certify.data-provider-plugin.issuer-uri}/issuance/credential',\
    'display': [{\
      'name': 'AgriQCert - Agricultural Quality Certification',\
      'locale': 'en',\
      'logo': {\
        'url': 'https://example.com/logo.png',\
        'alt_text': 'AgriQCert Logo'\
      }\
    }],\
    'credentials_supported': [{\
      'id': 'DigitalProductPassport',\
      'format': 'ldp_vc',\
      'scope': 'digital_product_passport',\
      'cryptographic_binding_methods_supported': ['did:jwk', 'did:key'],\
      'cryptographic_suites_supported': ['Ed25519Signature2020'],\
      'proof_types_supported': {\
        'jwt': {\
          'proof_signing_alg_values_supported': ['EdDSA', 'ES256']\
        }\
      },\
      'credential_definition': {\
        'type': ['VerifiableCredential', 'DigitalProductPassport', 'AgriculturalQualityCertificate'],\
        '@context': ['https://www.w3.org/2018/credentials/v1', 'https://w3id.org/tracability/v1']\
      },\
      'display': [{\
        'name': 'Digital Product Passport',\
        'locale': 'en',\
        'logo': {\
          'url': 'https://example.com/dpp-icon.png',\
          'alt_text': 'Digital Product Passport'\
        },\
        'background_color': '#2E7D32',\
        'text_color': '#FFFFFF'\
      }]\
    }]\
  }\
}

## Rendering Template Configuration (optional)
mosip.certify.data-provider-plugin.rendering-template-enabled=false
mosip.certify.data-provider-plugin.rendering-template-id=
